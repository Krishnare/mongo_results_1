db.airlines.aggregate([{$match:{"originCountry":"United States"}},{$group:{_id:{originState:"$originState", originCity:"$originCity"}, totalPassengers:{$max:{$sum:"$passengers"}}}},{"$sort":{"_id.originState": 1, "totalPassengers": -1}}, {"$group":{"_id":"$_id.originState","cityname":{"$first":"$_id.originCity"}, totalPas:{"$first":"$totalPassengers"}}},{"$sort":{"_id": 1}},{$limit:5}])