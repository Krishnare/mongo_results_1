Question 5:
5. Find the city (originCity) with the highest sum of passengers for each state (originState) of the United States (originCountry). Provide the city for the first 5 states ordered by state alphabetically (you should see the city for Alaska, Arizona and etc). Show result as { "totalPassengers" : 999, "location" : { "state" : "abc", "city" : "xyz" } }

db.airlines.aggregate([{$match:{"originCountry":"United States"}},{$group:{_id:{originState:"$originState", originCity:"$originCity"}, totalPassengers:{$max:{$sum:"$passengers"}}}},{"$sort":{"_id.originState": 1, "totalPassengers": -1}}, {"$group":{"_id":"$_id.originState","cityname":{"$first":"$_id.originCity"}, totalPas:{"$first":"$totalPassengers"}}},{"$sort":{"_id": 1}},{$limit:5}])

Ans:
{ "_id" : "Alabama", "cityname" : "Birmingham, AL", "totalPas" : 35021 }
{ "_id" : "Alaska", "cityname" : "Anchorage, AK", "totalPas" : 88556 }
{ "_id" : "Arizona", "cityname" : "Phoenix, AZ", "totalPas" : 54071 }
{ "_id" : "Arkansas", "cityname" : "Little Rock, AR", "totalPas" : 24661 }
{ "_id" : "California", "cityname" : "San Francisco, CA", "totalPas" : 82575 }